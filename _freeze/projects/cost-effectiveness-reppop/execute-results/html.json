{
  "hash": "f50eb552f8e4a94456b6081822be1478",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Cost-Effectiveness of the REPPOP Pediatric Obesity Management Program\"\nauthor: \"Ousmane Diallo\"\ndate: \"2025-10-27\"\nhighlight-style: pygments\npage-layout: article\nformat:\n  html:\n    toc: true\n    toc-depth: 2\n    #theme: cosmo\n    html-math-method: katex\n    #code-fold: true\n    #code-summary: \"Show code\"\n    #embed-resources: true\n    css: ../assets/css/remove-keyword.css\neditor: \n  markdown: \n    wrap: sentence\n---\n\n\n\n## Overview\n\nIn the Aquitaine region of France, as part of the Nutrition, Prevention, and Child Health Program—the regional extension of the National Nutrition and Health Program (PNNS) for children and adolescents—a harmonized screening and management approach for pediatric overweight and obesity was developed.\nThis initiative led to the creation of the REPPOP network (Réseau de Prévention et de Prise en charge de l’Obésité Pédiatrique), an integrated and multidisciplinary care system operating in the Gironde area.\n\nThe REPPOP network connects community physicians, hospital practitioners, and public health professionals (including school doctors, nurses, and maternal and child health services) with a central coordination team.\nChildren enrolled in REPPOP receive a two-year multidisciplinary follow-up, including regular medical visits and, when appropriate, nutritional and psychological counseling.\n\nAt admission, two inclusion consultations are conducted by the referring REPPOP physician:\n\n-   Inclusion visit 1: to exclude organic causes of obesity and detect complications.\n\n-   Inclusion visit 2: to establish an educational and behavioral management plan.\n\nThe attending physician and family then define personalized, realistic objectives for the child and determine the most suitable care pathway.\n\nDespite the broad implementation of this coordinated approach, no formal economic evaluation of the REPOP program had been performed.\nThe objective of this study was therefore to assess the cost-effectiveness of the REPOP pediatric obesity management strategy compared with no intervention.\n\n## Methodology Framework\n\n### Data sources\n\nThe primary dataset came from the REPPOP cohort study, which followed children with overweight or obesity over a two-year period.\nThis database was used both to simulate the natural history of obesity prior to intervention and to perform the cost-effectiveness analysis.\nAfter excluding children with missing data on social difficulties, those followed for more than 3.5 years, and those older than 12 years at inclusion, 553 children remained for analysis.\nA second data source was a French national study estimating the medical costs associated with obesity, based on the 2002 Health, Health-Care and Insurance Survey (ESPS) linked to the Permanent Sample of Health Insurance Beneficiaries (EPAS), which was used to model long-term efficiency of the REPPOP strategy.\n\n### Data summary\n\nThe REPPOP cohort included **553 children** aged 6–12 years with complete two-year follow-up data.\\\nBaseline and follow-up variables included **age, gender, age at onset of overweight, social difficulties**, and **BMI Z-scores** at inclusion and after two years.\\\nThese variables were used to simulate counterfactual BMI trajectories and estimate the program’s incremental cost-effectiveness.\n\n### Simulation of the Natural History of the Disease\n\nBecause no untreated control group was available, a model-based simulation was built to estimate each child’s BMI *Z*-score trajectory without the REPPOP intervention.\\\nData were observed at two time points — **T₀ (baseline)** and **T + 2 years** — including age, gender, social difficulties, and BMI *Z*-scores.\n\nA **two-step modeling process** was applied:\n\n1.  The **two-year growth rate (X)** in BMI *Z*-score was computed for each child.\\\n2.  This growth rate was then modeled using a **multiple linear regression**, stratified by age group, with predictors: *age at onset of overweight*, *initial BMI Z-score*, *social difficulties*, and *gender*.\n\nThe model can be expressed as:\n\n$$\nX_i \\;=\\; \\beta_0 \\;+\\; \\beta_1\\,\\mathrm{AgeOnset}_i \\;+\\; \\beta_2\\,\\mathrm{ZBMI}_{i0}\n\\;+\\; \\beta_3\\,\\mathrm{Social}_i \\;+\\; \\beta_4\\,\\mathrm{Gender}_i \\;+\\; \\varepsilon_i,\n\\qquad \\varepsilon_i \\sim \\mathcal N(0,\\sigma^{2}).\n$$\n\nTo incorporate uncertainty, random residuals were drawn from a normal distribution and added to the predicted growth rates, generating individualized simulated Z-scores:\n\n$$\nZ_{i,\\mathrm{sim}} \\;=\\; Z_{i,\\mathrm{init}} \\;+\\; X_{i,\\mathrm{sim}}.\n$$\n\nThis approach allowed comparing each child’s *observed* BMI Z-score trajectory (with REPOP) to their *simulated* trajectory (without REPPOP).\n\n#### Example of R code\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Model-simulate-counterfactual\"}\n# ============================================================================\n# Stratified multiple linear regression of 2-year growth rate by age band\n# ============================================================================\n\nfits <- dat %>% \n  # Group data by age band for stratified analysis\n  group_by(age_band) %>% \n  \n  # Create a list-column containing data for each group\n  nest() %>% \n  \n  mutate(\n    # Fit a linear regression model for each age band\n    # Predictors: baseline BMI-Z, sex, age at onset, social factors\n    # Outcome: observed growth rate\n    model = map(data, ~ lm(growth_rate_obs ~ zbmi_incl + sex + age_onset + social, \n                           data = .x)),\n    \n    # Extract residual standard error (sigma) from each model\n    # Used to simulate natural data variability\n    sigma = map_dbl(model, ~ summary(.x)$sigma),\n    \n    # Predict mean value (mu) for each observation\n    # Based on the fitted model\n    pred_mu = map2(model, data, ~ predict(.x, newdata = .y)),\n    \n    # Generate random residuals following a normal distribution\n    # Mean = 0, standard deviation = model sigma\n    resid_rnd = map2(pred_mu, sigma, ~ rnorm(length(.x), 0, .y)),\n    \n    # Create simulated growth by adding residual noise\n    # to predictions (mu + epsilon)\n    growth_sim = map2(pred_mu, resid_rnd, ~ .x + .y)\n  )\n\n# ============================================================================\n# Attach simulated growth and build counterfactual Z-score at 2 years\n# ============================================================================\n\nsim <- fits %>% \n  # Select only necessary columns\n  select(age_band, data, growth_sim) %>% \n  \n  # Unnest data to return to tabular format\n  unnest(c(data, growth_sim)) %>% \n  \n  mutate(\n    # Calculate counterfactual Z-score at 2 years (scenario WITHOUT REPOP intervention)\n    # Baseline Z + simulated growth\n    z_sim_2y = zbmi_incl + growth_sim,\n    \n    # Observed change in Z-score WITH REPOP intervention\n    # (difference between final Z and baseline Z)\n    delta_z_repop = zbmi_last - zbmi_incl,\n    \n    # Simulated change in Z-score WITHOUT intervention\n    # (difference between counterfactual Z and baseline Z)\n    delta_z_nocare = z_sim_2y - zbmi_incl\n  )\n\n# ============================================================================\n# Quick check: display model coefficients for the first age band\n# ============================================================================\n\nfits$model[[1]] %>% tidy()\n```\n:::\n\n\n\n### Cost-Effectiveness Analysis\n\nThe cost-effectiveness model was conducted from the payer perspective (French national health insurance).\nIn line with recommendations from the Haute Autorité de Santé (HAS), the therapeutic goal in children is not weight loss but rather stabilization or deceleration of BMI growth.\n\nAccordingly, two measures of effectiveness were used:\n\n-   a normative criterion — stabilization of BMI Z-score (no increase), and\n\n-   a quantitative criterion — the cost per one-unit reduction in BMI Z-score over two years.\n\nOnly direct medical costs were included in the analysis, covering physician, dietitian, psychologist, and inclusion consultations.\nAll costs were expressed in euros (€) and not discounted, given the short (two-year) time horizon of the REPOP intervention.\n\nThe incremental cost-effectiveness ratio (ICER) was computed as the difference in mean costs divided by the difference in mean effects between the REPPOP intervention and the “no-intervention” simulated scenario:\n\n$$\nICER \\;=\\; \\frac{\\Delta C}{\\Delta E}\n$$\n\nwhere ΔC is the incremental cost and ΔE the incremental effectiveness (reduction in BMI Z-score).\n\n#### R code\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Cost-Effectiveness Analysis\"}\n# ============================================================================\n# Define unit costs (EUR) for each type of consultation\n# ============================================================================\nunit <- list(\n  med = 20,    # Medical consultation\n  psy = 40,    # Psychology consultation\n  diet = 40,   # Dietitian consultation\n  incl = 60    # Inclusion visit\n)\n\n# ============================================================================\n# Calculate costs and effects for REPOP intervention vs no care\n# ============================================================================\nce <- sim %>% \n  mutate(\n    # Total cost of REPOP intervention\n    # Sum of all consultations weighted by their unit costs\n    # coalesce() replaces NA with 0 to handle missing consultation counts\n    cost_repop = coalesce(n_consult_med, 0) * unit$med + \n                 coalesce(n_consult_psy, 0) * unit$psy + \n                 coalesce(n_consult_diet, 0) * unit$diet + \n                 coalesce(n_consult_incl, 0) * unit$incl,\n    \n    # Cost of no care scenario (reference = 0)\n    cost_nocare = 0,\n    \n    # Effect: reduction in BMI Z-score (higher = better)\n    # Negative sign converts decrease in Z to a positive outcome\n    eff_repop = -(delta_z_repop),     # Effect with REPOP\n    eff_nocare = -(delta_z_nocare),   # Effect without care\n    \n    # Incremental cost (difference between REPOP and no care)\n    incr_cost = cost_repop - cost_nocare,\n    \n    # Incremental effect (difference in effectiveness)\n    incr_eff = eff_repop - eff_nocare\n  )\n\n# ============================================================================\n# Summarize cost-effectiveness metrics\n# ============================================================================\nsummary_ce <- ce %>% \n  summarize(\n    n = n(),                                           # Sample size\n    mean_cost = mean(cost_repop, na.rm = TRUE),       # Mean cost of REPOP\n    mean_eff_R = mean(eff_repop, na.rm = TRUE),       # Mean effect with REPOP\n    mean_eff_N = mean(eff_nocare, na.rm = TRUE),      # Mean effect without care\n    dC = mean(incr_cost, na.rm = TRUE),               # Mean incremental cost (ΔC)\n    dE = mean(incr_eff, na.rm = TRUE),                # Mean incremental effect (ΔE)\n    ICER = dC / dE                                     # Incremental Cost-Effectiveness Ratio\n  )\n\nsummary_ce\n```\n:::\n\n\n\n#### **Uncertainty Analysis**\n\nTo account for sampling uncertainty, a non-parametric bootstrap method was applied with 10,000 replications.\nIn each bootstrap sample, mean costs and mean effects were recalculated, and the ICER was recomputed.\nThe 95% confidence interval for the ICER was derived using the percentile method, by discarding the lowest and highest 2.5% of simulated ICER values.\n\nThis approach is recommended when no strong assumptions can be made regarding the distribution of incremental costs and effects.\nThe resulting bootstrap replications were plotted on the cost-effectiveness (CE) plane, illustrating the joint uncertainty around the incremental cost and incremental effectiveness estimates.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Non-parametric bootstrap\"}\n# Number of bootstrap replicates\nB <- 10000L\nn <- nrow(ce)\n\n# Generate bootstrap sample indices (with replacement)\nidx <- replicate(B, sample.int(n, replace = TRUE))\n\n# Perform bootstrap iterations\nboot <- map_dfr(1:B, function(b) {\n  # Extract bootstrap sample\n  s <- ce[idx[, b], , drop = FALSE]\n  \n  # Calculate mean incremental cost and effect for this sample\n  dC <- mean(s$incr_cost, na.rm = TRUE)\n  dE <- mean(s$incr_eff, na.rm = TRUE)\n  \n  # Return bootstrap replicate\n  tibble(\n    mean_cost = dC,\n    mean_eff = dE,\n    icer = dC / dE    # ICER for this bootstrap sample\n  )\n})\n\n# Calculate 95% confidence interval for ICER\n# Filter out infinite values (when dE = 0)\nci_icer <- quantile(\n  boot$icer[is.finite(boot$icer)], \n  probs = c(0.025, 0.975), \n  na.rm = TRUE\n)\n\n# Display results\nlist(\n  point_estimates = summary_ce,\n  icer_CI = ci_icer\n)\n\n# ============================================================================\n# Cost-Effectiveness Plane Visualization\n# ============================================================================\n#| label: ce-plane\n#| fig-cap: \"Cost-effectiveness (CE) plane: bootstrap distribution of incremental cost (ΔC) vs incremental effectiveness (ΔE).\"\n#| fig-align: center\n#| out-width: 70%\n\nggplot(boot, aes(x = mean_eff, y = mean_cost)) + \n  # Plot bootstrap replicates as semi-transparent points\n  geom_point(alpha = 0.25, size = 0.7) + \n  \n  # Add reference lines at zero\n  geom_vline(xintercept = 0, linetype = \"dashed\") +  # No effect line\n  geom_hline(yintercept = 0, linetype = \"dashed\") +  # No cost line\n  \n  # Labels\n  labs(\n    x = expression(Delta*E),           # Incremental effect\n    y = expression(Delta*C),           # Incremental cost\n    title = \"Bootstrap Cost-Effectiveness Plane (REPOP vs No Care)\"\n  )\n```\n:::\n\n\n\n### Efficiency Analysis (Long-Term Cost Offsets)\n\nTo estimate the long-term cost savings associated with the REPOP intervention, we used data from a French national study that assessed the medical costs attributable to obesity in France.\nThis reference study combined data from the 2002 Health, Health-Care and Insurance Survey (ESPS) and the Permanent Sample of Health Insurance Beneficiaries (EPAS), covering the three main social security schemes.\nIt provided national estimates of annual direct medical costs associated with obesity, used here to extrapolate the future costs avoided through the REPPOP program.\n\nAssumptions were made regarding the percentage of obesity cases prevented by the intervention and the discount rate applied to future costs.\nWe assumed that 16% of obesity cases were avoided among REPPOP participants, and annual costs were discounted at 2% and 4%, consistent with French health-economic guidelines.\n\n#### **Number of Obesity Cases Prevented**\n\nThe proportion of obesity cases prevented after two years of REPOP care was calculated as:\n\n$$\n\\text{Obesity Prevented (\\%)} \\;=\\;\n\\frac{N_{\\mathrm{obese,\\;simulated}} - N_{\\mathrm{obese,\\;REPOP}}}\n     {N_{\\mathrm{obese,\\;simulated}}}\n\\times 100\n$$\n\nwhere (N\\_{\\mathrm{obese,\\;simulated}}) is the number of children classified as obese at 2 years in the no-intervention (counterfactual) simulation, and (N\\_{\\mathrm{obese,\\;REPOP}}) is the number observed after REPOP care.\n\n#### **Discounted Cost Savings**\n\nThe present value (PV) of avoided obesity-related costs was computed as:\n\n**Simple (T-year horizon):** $$\nPV \\;=\\; \\sum_{t=1}^{T} \\frac{p \\times C}{(1+r)^{t}}\n$$\n\n**Age-based (benefits from age (a_s) to (a_e), intervention at age (a_0)):** $$\nPV \\;=\\; \\sum_{a=a_s}^{a_e-1} \\frac{p \\times C}{(1+r)^{\\,a - a_0}}\n$$\n\nwith:\n\n-   (p): proportion of obesity cases prevented (e.g., (16%) (\\Rightarrow) use (p=0.16)),\n\n-   (C): mean **annual** direct medical cost of obesity (from the national cost study),\n\n-   (r): annual discount rate (e.g., (0.02) or (0.04)),\n\n-   (T): number of years of accrual (simple form),\n\n-   (a_0): age at intervention start, (a_s): benefit start age, (a_e): benefit end age (age-based form).\n\nThis calculation provides an estimate of the discounted long-term cost offsets achieved through the REPOP program, based on its short-term effectiveness in reducing pediatric obesity.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"efficiency-longterm\"}\n# ============================================================================\n# Calculate long-term cost offsets using present value (PV)\n# ============================================================================\n\n# Function to compute present value of avoided future costs\n# p: probability of avoiding obesity case\n# C: annual direct medical cost of obesity (EUR)\n# r: discount rate (annual)\n# a0: current age (baseline)\n# a_start: age when cost savings begin\n# a_end: age when cost savings end\npv_avoided <- function(p, C, r, a0, a_start, a_end) {\n  # Create vector of years from start to end age\n  years <- a_start:(a_end - 1)\n  \n  # Sum discounted costs over all years\n  # Formula: PV = Σ [p × C / (1 + r)^(t - a0)]\n  # where t is each year from a_start to a_end\n  sum(p * C / ((1 + r)^(years - a0)))\n}\n\n# ============================================================================\n# Define parameters from study scenarios\n# ============================================================================\np <- 0.16    # Probability: 16% of obesity cases avoided by intervention\nC <- 506     # Mean annual direct medical cost of obesity (EUR)\na0 <- 8      # Baseline age (years)\n\n# ============================================================================\n# Calculate present value for multiple time horizons and discount rates\n# ============================================================================\nscenarios <- tribble(\n  ~window,      ~a_start, ~a_end, ~r,\n  \"18–60 @2%\",  18,       60,     0.02,   # Ages 18-60, 2% discount rate\n  \"18–60 @4%\",  18,       60,     0.04,   # Ages 18-60, 4% discount rate\n  \"40–60 @2%\",  40,       60,     0.02,   # Ages 40-60, 2% discount rate\n  \"40–60 @4%\",  40,       60,     0.04    # Ages 40-60, 4% discount rate\n) %>% \n  rowwise() %>% \n  # Calculate present value for each scenario\n  mutate(PV = pv_avoided(p, C, r, a0, a_start, a_end)) %>% \n  ungroup()\n\nscenarios\n\n# ============================================================================\n# One-way sensitivity analysis on costs (±20%)\n# ============================================================================\n#| label: ows-sa\n\n# Test cost variations: 80%, 100%, and 120% of base case\nscale_vec <- c(0.8, 1.0, 1.2)\n\n# Perform sensitivity analysis for each cost scaling factor\nsa <- map_dfr(scale_vec, function(s) {\n  # Scale incremental costs by factor s\n  s_ce <- ce %>% \n    mutate(incr_cost = incr_cost * s)\n  \n  # Recalculate mean incremental cost and effect\n  dC <- mean(s_ce$incr_cost, na.rm = TRUE)\n  dE <- mean(s_ce$incr_eff, na.rm = TRUE)\n  \n  # Return sensitivity analysis results\n  tibble(\n    scale = s,              # Scaling factor (0.8, 1.0, or 1.2)\n    incr_cost = dC,         # Scaled incremental cost\n    incr_eff = dE,          # Incremental effect (unchanged)\n    ICER = dC / dE          # Recalculated ICER\n  )\n})\n\nsa\n```\n:::\n\n\n\n\n## Results\n\n### Baseline Characteristics\n\nThe REPPOP cohort included **553 children** (57.7% girls, sex ratio 0.7) with a mean age of **9.4 years (SD = 2.3)** and a mean age at onset of overweight of **2.7 years (SD = 1.6)**.\nThe mean baseline BMI Z-score was **3.34 SD (SD = 0.97); 52.5%** of participants were classified as obese and **47.5%** as overweight.\nOverall, 16.6% of children had documented social difficulties.\nDuring the two-year program, participants attended on average **5.6 medical, 8.1 psychological, and 8.0 dietary** consultations.\n\n### Simulation of the Natural History of Obesity\n\nIn the regression model predicting BMI Z-score growth rate, a one-point increase in BMI Z-score at baseline was associated with a **57% higher estimated growth rate (p \\< 0.05)**.\nFor example, among girls aged 2–4 years, with onset of overweight at 3 years and initial BMI Z-score = 1.95 SD, the predicted growth rate was **1.63 \\[95% CI: 1.01–2.26\\]**.\n\n| **Variable**                | **Coefficient** | **Std. Error** | **p-value** |\n|-----------------------------|-----------------|----------------|-------------|\n| BMI Z-score (age 1)         | -0.57           | 0.09           | \\< 0.001    |\n| Male (1 = Yes)              | 0.16            | 0.27           | 0.55        |\n| Age at onset of overweight  | -0.01           | 0.03           | 0.85        |\n| Social difficulty (1 = Yes) | 0.11            | 0.32           | 0.71        |\n| Constant                    | 2.66            | 0.29           | \\< 0.001    |\n| *N*                         | 196             |                |             |\n\n### Cost-Effectiveness Analysis\n\nThe mean cost per child for the two-year REPOP intervention was €440.51 \\[414.38 – 466.78\\].\nThe intervention produced an average BMI Z-score reduction of 1.6 SD compared with the simulated no-treatment scenario.\n\nThe resulting incremental cost-effectiveness ratio (ICER) was:\n\nICER=€275.3\\[181.6–402.0\\] per1 SD reduction in BMI Z-score.\n\n| **Resource item**          | **Unit cost (€)** | **Source** |\n|----------------------------|-------------------|------------|\n| Medical consultation       | 20                | REPOP      |\n| Psychological consultation | 40                | REPOP      |\n| Dietetic consultation      | 40                | REPOP      |\n| Inclusion consultation     | 60                | REPOP      |\n\nA non-parametric bootstrap (10 000 replications) confirmed the stability of the ICER distribution, which was visualized on the cost-effectiveness (CE) plane.\n\n### Efficiency (Long-Term Cost Offsets)\n\nUsing national cost-of-obesity data (mean annual medical cost = €506), the discounted cost savings associated with the REPOP intervention were estimated under different scenarios:\n\n| **Scenario** | **Discount rate** | **Time horizon** | **Estimated discounted cost savings (€)** |\n|----------------|---------------|---------------|--------------------------|\n| Benefits from age 18 to 60 | 2 % | 42 years | 2 933.9 |\n|  | 4 % | 42 years | 2 441.6 |\n| Benefits from age 40 to 60 | 2 % | 20 years | 892.8 |\n|  | 4 % | 20 years | 495.2 |\n\nThe proportion of obesity cases that would need to be prevented for the REPOP intervention to be cost-neutral over the 18–60 year period was estimated at 2% (X = 0.02).\n\n## Cost-Effectiveness Plane (Bootstrap Distribution)\n\n![Fig: Cost-effectiveness (CE) plane showing the bootstrap distribution of incremental costs (ΔĈ) versus incremental effects (ΔÊ).](images/bootstrap.png)\n\n## Interpretation & Key Takeaways\n\n-   The REPPOP program reduced BMI Z-score by **1.6 SD** over two years compared with the simulated no-intervention scenario.\\\n-   The **mean cost per child** was **€440.5**, resulting in an **ICER of €275 per one-unit BMI Z-score reduction** — a moderate cost for meaningful clinical benefit.\\\n-   REPOP falls in the **northeast quadrant** of the CE plane (more costly but more effective), consistent with preventive public health interventions.\\\n-   Compared with published studies, REPOP demonstrated **stronger clinical effectiveness** and **competitive cost-efficiency**.\\\n-   Findings highlight the **economic value of multidisciplinary obesity management programs** in children and demonstrate your ability to apply **HEOR modeling, cost-effectiveness methods, and bootstrap-based uncertainty analysis**.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}